<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escala de Trauma de Davidson (DTS)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #29A98C 0%, #112F33 100%);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        .card.active {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card h1 {
            background: linear-gradient(135deg, #29A98C, #112F33);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2.2em;
            font-weight: 700;
            text-align: center;
            margin-bottom: 20px;
        }

        .card h2 {
            background: linear-gradient(135deg, #29A98C, #112F33);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 1.8em;
            font-weight: 600;
            text-align: center;
            margin-bottom: 25px;
        }

        .instructions {
            background: linear-gradient(135deg, rgba(41, 169, 140, 0.1), rgba(17, 47, 51, 0.1));
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border-left: 4px solid #29A98C;
        }

        .instructions p {
            color: #112F33;
            line-height: 1.6;
            font-size: 1.1em;
            margin-bottom: 15px;
        }

        .scale-legend {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .legend-section {
            background: rgba(41, 169, 140, 0.05);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(41, 169, 140, 0.2);
        }

        .legend-section h4 {
            color: #29A98C;
            font-weight: 600;
            margin-bottom: 10px;
            text-align: center;
        }

        .legend-section p {
            color: #112F33;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .question-header {
            background: linear-gradient(135deg, #29A98C, #112F33);
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            text-align: center;
        }

        .question-number {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .question-text {
            font-size: 1.3em;
            line-height: 1.4;
            color: #112F33;
            margin-bottom: 30px;
            text-align: center;
            font-weight: 500;
        }

        .response-section {
            margin-bottom: 25px;
        }

        .response-label {
            color: #29A98C;
            font-weight: 600;
            font-size: 1.1em;
            margin-bottom: 15px;
            text-align: center;
        }

        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }

        .option {
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 12px 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 500;
            color: #112F33;
            font-size: 0.9em;
        }

        .option:hover {
            border-color: #29A98C;
            background: rgba(41, 169, 140, 0.1);
            transform: translateY(-2px);
        }

        .option.selected {
            background: linear-gradient(135deg, #29A98C, #112F33);
            color: white;
            border-color: #29A98C;
            box-shadow: 0 4px 15px rgba(41, 169, 140, 0.3);
        }

        .back-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, #29A98C, #112F33);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 15px 25px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(41, 169, 140, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(41, 169, 140, 0.4);
        }

        .back-button.hidden {
            display: none;
        }

        .progress-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            height: 6px;
            background: linear-gradient(90deg, #29A98C, #112F33);
            transition: width 0.5s ease;
            z-index: 1000;
            border-radius: 0 3px 0 0;
        }

        .completion-message {
            text-align: center;
            margin-bottom: 30px;
        }

        .completion-message h2 {
            color: #29A98C;
            font-size: 2em;
            margin-bottom: 15px;
        }

        .completion-message p {
            color: #112F33;
            font-size: 1.2em;
            line-height: 1.6;
        }

        .final-button {
            background: linear-gradient(135deg, #29A98C, #112F33);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 20px 40px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .final-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(41, 169, 140, 0.3);
        }

        .results-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .test-info {
            background: linear-gradient(135deg, rgba(41, 169, 140, 0.1), rgba(17, 47, 51, 0.1));
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            text-align: center;
            border: 1px solid rgba(41, 169, 140, 0.2);
        }

        .test-info h3 {
            color: #29A98C;
            margin-bottom: 10px;
        }

        .score-summary {
            background: linear-gradient(135deg, rgba(41, 169, 140, 0.1), rgba(17, 47, 51, 0.1));
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            text-align: center;
            border: 2px solid rgba(41, 169, 140, 0.2);
        }

        .total-score-item {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #29A98C;
            margin-bottom: 20px;
        }

        .total-score-label {
            color: #29A98C;
            font-weight: 700;
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .total-score-value {
            font-size: 3em;
            font-weight: 700;
            color: #112F33;
        }

        .score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .score-item {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(41, 169, 140, 0.2);
        }

        .score-label {
            color: #29A98C;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .score-value {
            font-size: 2em;
            font-weight: 700;
            color: #112F33;
        }

        .subscales-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 30px;
            border-left: 5px solid #29A98C;
        }

        .subscales-section h3 {
            color: #29A98C;
            font-size: 1.3em;
            margin-bottom: 15px;
        }

        .subscale-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .subscale-item {
            background: rgba(41, 169, 140, 0.05);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(41, 169, 140, 0.2);
        }

        .subscale-name {
            color: #29A98C;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .subscale-items {
            color: #112F33;
            font-size: 0.9em;
        }

        .interpretation {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            border-left: 5px solid #29A98C;
        }

        .interpretation h3 {
            color: #29A98C;
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        .interpretation p {
            color: #112F33;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .severity-level {
            padding: 15px;
            border-radius: 12px;
            margin: 20px 0;
            font-weight: 600;
            text-align: center;
        }

        .severity-minimal {
            background: rgba(72, 187, 120, 0.2);
            color: #276749;
            border: 2px solid #48bb78;
        }

        .severity-mild {
            background: rgba(246, 173, 85, 0.2);
            color: #744210;
            border: 2px solid #f6ad55;
        }

        .severity-moderate {
            background: rgba(237, 137, 54, 0.2);
            color: #7c2d12;
            border: 2px solid #ed8936;
        }

        .severity-severe {
            background: rgba(245, 101, 101, 0.2);
            color: #742a2a;
            border: 2px solid #f56565;
        }

        .alerts-section {
            background: rgba(245, 101, 101, 0.1);
            border: 2px solid #f56565;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .alerts-section h3 {
            color: #742a2a;
            margin-bottom: 15px;
        }

        .alert-item {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #f56565;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .action-button {
            background: linear-gradient(135deg, #29A98C, #112F33);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 15px 25px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(41, 169, 140, 0.3);
        }

        .action-button.secondary {
            background: linear-gradient(135deg, #112F33, #29A98C);
        }

        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            .card {
                padding: 25px;
            }
            
            .card h1 {
                font-size: 1.8em;
            }
            
            .options {
                grid-template-columns: 1fr;
            }
            
            .scale-legend {
                grid-template-columns: 1fr;
            }

            .total-score-value {
                font-size: 2.5em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Card 0: Bienvenida e Instrucciones -->
        <div class="card active" id="card-0">
            <h1>Escala de Trauma de Davidson (DTS)</h1>
            <div class="instructions">
                <p><strong>Instrucciones para el paciente:</strong></p>
                <p>Cada una de las siguientes preguntas se refiere a un síntoma específico. Considere, para cada pregunta, cuántas veces le ha molestado el síntoma y con cuánta intensidad, durante la <strong>última semana</strong>.</p>
                <p>Para cada pregunta, deberá seleccionar dos respuestas:</p>
                <p><strong>🔢 FRECUENCIA:</strong> ¿Con qué frecuencia le ha molestado este síntoma?</p>
                <p><strong>⚡ GRAVEDAD:</strong> ¿Qué tan intenso o grave ha sido este síntoma?</p>
                
                <div class="scale-legend">
                    <div class="legend-section">
                        <h4>🔢 FRECUENCIA</h4>
                        <p>⚪ NUNCA</p>
                        <p>🔵 A VECES</p>
                        <p>🟡 2-3 VECES</p>
                        <p>🟠 4 a 6 VECES</p>
                        <p>🔴 A DIARIO</p>
                    </div>
                    <div class="legend-section">
                        <h4>⚡ GRAVEDAD</h4>
                        <p>⚪ NADA</p>
                        <p>🟢 LEVE</p>
                        <p>🟡 MODERADO</p>
                        <p>🟠 MARCADO</p>
                        <p>🔴 EXTREMA</p>
                    </div>
                </div>
            </div>
            <button class="final-button" onclick="startScale()">Comenzar Evaluación</button>
        </div>

        <!-- Cards 1-17: Preguntas individuales -->
        <div class="card" id="card-1">
            <div class="question-header">
                <div class="question-number">Pregunta 1 de 17</div>
            </div>
            <div class="question-text">¿Ha tenido alguna vez imágenes, recuerdos o pensamientos dolorosos del acontecimiento?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="1" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="1" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-2">
            <div class="question-header">
                <div class="question-number">Pregunta 2 de 17</div>
            </div>
            <div class="question-text">¿Ha tenido alguna vez pesadillas sobre el acontecimiento?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="2" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="2" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-3">
            <div class="question-header">
                <div class="question-number">Pregunta 3 de 17</div>
            </div>
            <div class="question-text">¿Ha sentido que el acontecimiento estaba ocurriendo de nuevo? ¿Como si lo estuviera reviviendo?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="3" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="3" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-4">
            <div class="question-header">
                <div class="question-number">Pregunta 4 de 17</div>
            </div>
            <div class="question-text">¿Le ha molestado alguna cosa que se lo haya recordado?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="4" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="4" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-5">
            <div class="question-header">
                <div class="question-number">Pregunta 5 de 17</div>
            </div>
            <div class="question-text">¿Ha tenido manifestaciones físicas por recuerdos del acontecimiento? (Incluye sudores, temblores, taquicardia, disnea, náuseas o diarrea)</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="5" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="5" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-6">
            <div class="question-header">
                <div class="question-number">Pregunta 6 de 17</div>
            </div>
            <div class="question-text">¿Ha estado evitando algún pensamiento o sentimiento sobre el acontecimiento?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="6" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="6" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-7">
            <div class="question-header">
                <div class="question-number">Pregunta 7 de 17</div>
            </div>
            <div class="question-text">¿Ha estado evitando actividades, lugares o personas que se lo recuerden?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="7" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="7" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-8">
            <div class="question-header">
                <div class="question-number">Pregunta 8 de 17</div>
            </div>
            <div class="question-text">¿Ha sido incapaz de recordar partes importantes del acontecimiento?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="8" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="8" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-9">
            <div class="question-header">
                <div class="question-number">Pregunta 9 de 17</div>
            </div>
            <div class="question-text">¿Ha tenido dificultad para disfrutar de las cosas?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="9" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="9" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-10">
            <div class="question-header">
                <div class="question-number">Pregunta 10 de 17</div>
            </div>
            <div class="question-text">¿Se ha sentido distante o alejado de la gente?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="10" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="10" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-11">
            <div class="question-header">
                <div class="question-number">Pregunta 11 de 17</div>
            </div>
            <div class="question-text">¿Ha sido incapaz de tener sentimientos de tristeza o de afecto?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="11" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="11" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-12">
            <div class="question-header">
                <div class="question-number">Pregunta 12 de 17</div>
            </div>
            <div class="question-text">¿Ha tenido dificultad para imaginar una vida larga y cumplir sus objetivos?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="12" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="12" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-13">
            <div class="question-header">
                <div class="question-number">Pregunta 13 de 17</div>
            </div>
            <div class="question-text">¿Ha tenido dificultad para iniciar o mantener el sueño?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="13" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="13" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-14">
            <div class="question-header">
                <div class="question-number">Pregunta 14 de 17</div>
            </div>
            <div class="question-text">¿Ha estado irritable o ha tenido accesos de ira?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="14" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="14" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-15">
            <div class="question-header">
                <div class="question-number">Pregunta 15 de 17</div>
            </div>
            <div class="question-text">¿Ha tenido dificultades de concentración?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="15" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="15" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-16">
            <div class="question-header">
                <div class="question-number">Pregunta 16 de 17</div>
            </div>
            <div class="question-text">¿Se ha sentido nervioso, fácilmente distraído o ha permanecido «en guardia»?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="16" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="16" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <div class="card" id="card-17">
            <div class="question-header">
                <div class="question-number">Pregunta 17 de 17</div>
            </div>
            <div class="question-text">¿Ha estado nervioso o se ha asustado fácilmente?</div>
            
            <div class="response-section">
                <div class="response-label">FRECUENCIA</div>
                <div class="options" data-question="17" data-type="frequency">
                    <div class="option" data-value="0">NUNCA</div>
                    <div class="option" data-value="1">A VECES</div>
                    <div class="option" data-value="2">2-3 VECES</div>
                    <div class="option" data-value="3">4 a 6 VECES</div>
                    <div class="option" data-value="4">A DIARIO</div>
                </div>
            </div>

            <div class="response-section">
                <div class="response-label">GRAVEDAD</div>
                <div class="options" data-question="17" data-type="severity">
                    <div class="option" data-value="0">NADA</div>
                    <div class="option" data-value="1">LEVE</div>
                    <div class="option" data-value="2">MODERADO</div>
                    <div class="option" data-value="3">MARCADO</div>
                    <div class="option" data-value="4">EXTREMA</div>
                </div>
            </div>
        </div>

        <!-- Card Final -->
        <div class="card" id="card-final">
            <div class="completion-message">
                <h2>✓ Escala Completada</h2>
                <p>Muchas gracias por completar la evaluación.</p>
                <p><strong>Por favor, pase el dispositivo a su médico o profesional de salud mental para la revisión de los resultados.</strong></p>
            </div>
            <button class="final-button" onclick="showResults()">Revisar Resultados (Médico)</button>
        </div>

        <!-- Card Results -->
        <div class="card" id="card-results">
            <div class="results-container">
                <h1>Resultados de la Escala DTS</h1>
                
                <div class="test-info">
                    <h3>📋 Información de la Aplicación</h3>
                    <p><strong>Fecha y hora de aplicación:</strong> <span id="test-datetime"></span></p>
                </div>

                <div class="score-summary">
                    <h2>Puntuaciones Obtenidas</h2>
                    
                    <div class="total-score-item">
                        <div class="total-score-label">TOTAL DTS</div>
                        <div class="total-score-value" id="total-score">--</div>
                        <small>(Rango: 0-136)</small>
                    </div>

                    <div class="score-grid">
                        <div class="score-item">
                            <div class="score-label">Frecuencia</div>
                            <div class="score-value" id="frequency-score">--</div>
                            <small>(0-68)</small>
                        </div>
                        <div class="score-item">
                            <div class="score-label">Gravedad</div>
                            <div class="score-value" id="severity-score">--</div>
                            <small>(0-68)</small>
                        </div>
                    </div>
                    <div id="severity-level-display"></div>
                </div>

                <div class="subscales-section">
                    <h3>📊 Subescalas DSM-IV</h3>
                    <div class="subscale-grid">
                        <div class="subscale-item">
                            <div class="subscale-name">Reexperimentación (Cluster B)</div>
                            <div class="subscale-items">Ítems 1-5</div>
                        </div>
                        <div class="subscale-item">
                            <div class="subscale-name">Evitación/Embotamiento (Cluster C)</div>
                            <div class="subscale-items">Ítems 6-12</div>
                        </div>
                        <div class="subscale-item">
                            <div class="subscale-name">Hiperactivación (Cluster D)</div>
                            <div class="subscale-items">Ítems 13-17</div>
                        </div>
                    </div>
                </div>

                <div class="interpretation">
                    <h3>Interpretación Clínica</h3>
                    <div id="interpretation-content"></div>
                </div>

                <div id="alerts-section"></div>

                <div class="interpretation">
                    <h3>Información Técnica</h3>
                    <p><strong>Punto de corte validado:</strong> Una puntuación total ≥40 sugiere presencia de síntomas compatibles con TEPT (sensibilidad 69%, especificidad 95%, precisión diagnóstica 83%).</p>
                    <p><strong>Normativa poblacional:</strong> La puntuación media en población general es 11.0 ± 18.1 puntos.</p>
                    <p><strong>Periodo de evaluación:</strong> Síntomas experimentados durante la última semana.</p>
                </div>

                <div class="action-buttons">
                    <button class="action-button" onclick="exportToPDF()">📄 Exportar PDF</button>
                    <button class="action-button" onclick="exportToImage()">📸 Capturar Imagen</button>
                    <button class="action-button secondary" onclick="startNewEvaluation()">🔄 Nueva Evaluación</button>
                </div>
            </div>
        </div>
    </div>

    <button class="back-button" id="back-button" onclick="goBack()">← Regresar</button>
    <div class="progress-bar" id="progress-bar"></div>

    <script>
        // Variables globales
        let currentCard = 0;
        let responses = {};
        let totalQuestions = 17;
        let testStartTime = null;

        // Inicializar la aplicación
        function startScale() {
            testStartTime = new Date();
            currentCard = 1;
            showCard(currentCard);
            updateProgress();
            document.getElementById('back-button').classList.remove('hidden');
        }

        // Mostrar tarjeta específica
        function showCard(cardNumber) {
            document.querySelectorAll('.card').forEach(card => {
                card.classList.remove('active');
            });
            
            document.getElementById(`card-${cardNumber}`).classList.add('active');
            
            // Ocultar botón de regresar en cards especiales
            if (cardNumber === 0 || cardNumber === 'final' || cardNumber === 'results') {
                document.getElementById('back-button').classList.add('hidden');
            } else {
                document.getElementById('back-button').classList.remove('hidden');
            }
        }

        // Seleccionar opción
        function selectOption(questionNum, type, value, element) {
            // Marcar la opción seleccionada
            element.parentNode.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');

            // Guardar respuesta
            if (!responses[questionNum]) {
                responses[questionNum] = {};
            }
            responses[questionNum][type] = parseInt(value);

            // Verificar si ambas respuestas están completas
            if (responses[questionNum].frequency !== undefined && responses[questionNum].severity !== undefined) {
                setTimeout(() => {
                    if (currentCard < totalQuestions) {
                        currentCard++;
                        showCard(currentCard);
                        updateProgress();
                    } else {
                        showCard('final');
                        updateProgress();
                    }
                }, 150);
            }
        }

        // Regresar a la tarjeta anterior
        function goBack() {
            if (currentCard > 1) {
                currentCard--;
                showCard(currentCard);
                updateProgress();
            } else if (currentCard === 1) {
                currentCard = 0;
                showCard(currentCard);
                updateProgress();
            }
        }

        // Actualizar barra de progreso
        function updateProgress() {
            const progress = (currentCard / (totalQuestions + 1)) * 100;
            document.getElementById('progress-bar').style.width = progress + '%';
        }

        // Calcular puntuaciones
        function calculateScore() {
            let frequencyTotal = 0;
            let severityTotal = 0;
            
            for (let i = 1; i <= totalQuestions; i++) {
                if (responses[i]) {
                    frequencyTotal += responses[i].frequency || 0;
                    severityTotal += responses[i].severity || 0;
                }
            }
            
            return {
                frequency: frequencyTotal,
                severity: severityTotal,
                total: frequencyTotal + severityTotal
            };
        }

        // Obtener interpretación
        function getInterpretation(totalScore) {
            if (totalScore < 10) {
                return {
                    level: "Mínimo",
                    class: "severity-minimal",
                    description: "Síntomas mínimos o ausentes. Puntuación dentro del rango normal de la población general.",
                    clinical: "Considerar explorar factores de protección actuales y fortalecer recursos de afrontamiento. Evaluar si existen factores estresantes recientes que puedan requerir atención preventiva."
                };
            } else if (totalScore < 25) {
                return {
                    level: "Leve",
                    class: "severity-mild",
                    description: "Síntomas leves que pueden requerir monitoreo clínico.",
                    clinical: "Explorar en detalle los clusters con mayor puntuación. Considerar evaluación de funcionamiento psicosocial y estrategias de intervención temprana. Revisar eventos traumáticos específicos y su procesamiento actual."
                };
            } else if (totalScore < 40) {
                return {
                    level: "Moderado",
                    class: "severity-moderate",
                    description: "Síntomas moderados que requieren evaluación clínica detallada.",
                    clinical: "Priorizar evaluación de subescalas DSM-IV para identificar clusters predominantes. Considerar evaluación complementaria de disociación, depresión comórbida y funcionamiento interpersonal. Revisar estrategias de afrontamiento actuales."
                };
            } else {
                return {
                    level: "Severo - Compatible con TEPT",
                    class: "severity-severe", 
                    description: "Puntuación ≥40 puntos sugiere presencia de TEPT según punto de corte validado.",
                    clinical: "Evaluar presencia de criterios DSM-5 completos para TEPT. Considerar evaluación de seguridad, ideación suicida, consumo de sustancias y trauma complejo. Revisar ítems de alta puntuación para focalizar intervenciones específicas."
                };
            }
        }

        // Identificar alertas
        function getAlerts(responses) {
            const alerts = [];
            const questions = [
                "Imágenes, recuerdos o pensamientos dolorosos",
                "Pesadillas sobre el acontecimiento", 
                "Revivir el acontecimiento",
                "Malestar por recordatorios",
                "Manifestaciones físicas por recuerdos",
                "Evitación de pensamientos/sentimientos",
                "Evitación de actividades/lugares/personas",
                "Incapacidad para recordar partes importantes",
                "Dificultad para disfrutar",
                "Sentirse distante de otros",
                "Incapacidad para sentimientos de tristeza/afecto",
                "Dificultad para imaginar el futuro",
                "Problemas de sueño",
                "Irritabilidad o accesos de ira",
                "Dificultades de concentración",
                "Hipervigilancia",
                "Sobresalto fácil"
            ];

            for (let i = 1; i <= totalQuestions; i++) {
                if (responses[i]) {
                    const totalItem = (responses[i].frequency || 0) + (responses[i].severity || 0);
                    if (totalItem >= 5) { // ≥66% del máximo (8)
                        alerts.push({
                            item: i,
                            question: questions[i-1],
                            score: totalItem,
                            frequency: responses[i].frequency || 0,
                            severity: responses[i].severity || 0
                        });
                    }
                }
            }
            
            return alerts;
        }

        // Mostrar resultados
        function showResults() {
            const scores = calculateScore();
            const interpretation = getInterpretation(scores.total);
            const alerts = getAlerts(responses);

            // Mostrar fecha y hora
            const now = new Date();
            const dateOptions = { 
                year: 'numeric', month: 'long', day: 'numeric',
                hour: '2-digit', minute: '2-digit'
            };
            document.getElementById('test-datetime').textContent = now.toLocaleDateString('es-ES', dateOptions);

            // Mostrar puntuaciones
            document.getElementById('frequency-score').textContent = scores.frequency;
            document.getElementById('severity-score').textContent = scores.severity;
            document.getElementById('total-score').textContent = scores.total;

            // Mostrar nivel de severidad
            const severityDisplay = document.getElementById('severity-level-display');
            severityDisplay.innerHTML = `<div class="severity-level ${interpretation.class}">${interpretation.level}</div>`;

            // Mostrar interpretación
            const interpretationContent = document.getElementById('interpretation-content');
            interpretationContent.innerHTML = `
                <p><strong>Nivel de síntomas:</strong> ${interpretation.description}</p>
                <p><strong>Consideraciones clínicas:</strong> ${interpretation.clinical}</p>
            `;

            // Mostrar alertas si existen
            const alertsSection = document.getElementById('alerts-section');
            if (alerts.length > 0) {
                let alertsHTML = `
                    <div class="alerts-section">
                        <h3>⚠️ Ítems de Alta Puntuación (Requieren Atención)</h3>
                        <p>Los siguientes síntomas obtuvieron puntuaciones elevadas (≥5 puntos):</p>
                `;
                
                alerts.forEach(alert => {
                    alertsHTML += `
                        <div class="alert-item">
                            <strong>Ítem ${alert.item}:</strong> ${alert.question}<br>
                            <small>Frecuencia: ${alert.frequency}, Gravedad: ${alert.severity}, Total: ${alert.score}/8</small>
                        </div>
                    `;
                });
                
                alertsHTML += '</div>';
                alertsSection.innerHTML = alertsHTML;
            } else {
                alertsSection.innerHTML = '';
            }

            showCard('results');
            updateProgress();
        }

        // Exportar a PDF
        function exportToPDF() {
            window.print();
        }

        // Exportar como imagen
        function exportToImage() {
            const resultsCard = document.getElementById('card-results');
            
            // Usar html2canvas si está disponible, sino usar captura nativa
            if (typeof html2canvas !== 'undefined') {
                html2canvas(resultsCard).then(canvas => {
                    const link = document.createElement('a');
                    link.download = 'resultados-dts.png';
                    link.href = canvas.toDataURL();
                    link.click();
                });
            } else {
                // Alternativa: copiar al portapapeles o guardar como datos
                alert('Funcionalidad de captura disponible. Use la función de impresión del navegador para guardar como PDF.');
            }
        }

        // Nueva evaluación
        function startNewEvaluation() {
            currentCard = 0;
            responses = {};
            testStartTime = null;
            
            // Limpiar todas las selecciones
            document.querySelectorAll('.option.selected').forEach(option => {
                option.classList.remove('selected');
            });
            
            showCard(0);
            updateProgress();
        }

        // Event listeners para las opciones
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.options').forEach(optionsContainer => {
                const questionNum = optionsContainer.getAttribute('data-question');
                const type = optionsContainer.getAttribute('data-type');
                
                optionsContainer.querySelectorAll('.option').forEach(option => {
                    option.addEventListener('click', function() {
                        const value = this.getAttribute('data-value');
                        selectOption(questionNum, type, value, this);
                    });
                });
            });
        });
    </script>
</body>
</html>